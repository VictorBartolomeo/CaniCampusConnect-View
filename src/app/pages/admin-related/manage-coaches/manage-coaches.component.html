<div class="manage-coaches-container">
  <h1>Gestion des Coachs</h1>

  <div class="flex flex-row gap-4">
    <!-- Table des coachs à gauche -->
    <div class="w-2/3 bg-white p-4 rounded-lg shadow">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-xl font-semibold">Liste des coachs</h2>
        <app-coach-register-form #coachForm (coachAdded)="loadCoaches()"></app-coach-register-form>
      </div>

      <p-table
        [value]="coaches"
        [loading]="loading"
        styleClass="p-datatable-sm"
        [paginator]="true"
        [rows]="10"
        [showCurrentPageReport]="true"
        currentPageReportTemplate="Affichage de {first} à {last} sur {totalRecords} coachs"
        [rowsPerPageOptions]="[5, 10, 25]">

        <ng-template pTemplate="header">
          <tr>
            <th>Nom</th>
            <th>Prénom</th>
            <th>Email</th>
            <th>Actions</th>
          </tr>
        </ng-template>

        <ng-template pTemplate="body" let-coach>
          <tr>
            <td>{{ coach.lastname }}</td>
            <td>{{ coach.firstname }}</td>
            <td>{{ coach.email }}</td>
            <td>
              <button
                pButton
                icon="pi pi-info-circle"
                class="p-button-rounded p-button-info p-button-sm mr-2"
                pTooltip="Voir les détails"
                (click)="showCoachDetails(coach)">
              </button>
            </td>
          </tr>
        </ng-template>

        <ng-template pTemplate="emptymessage">
          <tr>
            <td colspan="4" class="text-center p-4">
              <div *ngIf="loading">Chargement des coachs...</div>
              <div *ngIf="!loading">
                Aucun coach trouvé.
                <button
                  pButton
                  label="Ajouter un coach"
                  icon="pi pi-plus"
                  class="p-button-sm mt-2"
                  (click)="showAddCoachDialog()">
                </button>
              </div>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </div>

    <!-- Détails du coach sélectionné à droite -->
    <div class="w-1/3 bg-white p-4 rounded-lg shadow" *ngIf="selectedCoach">
      <h2 class="text-xl font-semibold mb-4">Détails du coach</h2>
      <div class="coach-details">
        <div class="mb-3">
          <span class="font-semibold">Nom:</span> {{ selectedCoach.lastname }}
        </div>
        <div class="mb-3">
          <span class="font-semibold">Prénom:</span> {{ selectedCoach.firstname }}
        </div>
        <div class="mb-3">
          <span class="font-semibold">Email:</span> {{ selectedCoach.email }}
        </div>
        <div class="mb-3">
          <span class="font-semibold">Téléphone:</span> {{ selectedCoach.phone || 'Non renseigné' }}
        </div>
        <div class="mb-3">
          <span class="font-semibold">Numéro ACACED:</span> {{ selectedCoach.acacedNumber }}
        </div>
        <div class="mb-3">
          <span class="font-semibold">Date d'inscription:</span> {{ selectedCoach.registrationDate | date:'dd/MM/yyyy' }}
        </div>
      </div>
    </div>

    <!-- Message si aucun coach n'est sélectionné -->
    <div class="w-1/3 bg-white p-4 rounded-lg shadow flex items-center justify-center" *ngIf="!selectedCoach">
      <div class="text-center text-gray-500">
        <i class="pi pi-user text-5xl mb-3"></i>
        <p>Sélectionnez un coach pour voir ses détails</p>
      </div>
    </div>
  </div>
</div>

<!-- Modal de détails du coach -->
<p-dialog
  header="Détails du coach"
  [(visible)]="detailsVisible"
  [modal]="true"
  [style]="{width: '30rem'}"
  [draggable]="false"
  [resizable]="false">

  <div class="coach-details p-4" *ngIf="selectedCoach">
    <div class="mb-3">
      <span class="font-semibold">Nom:</span> {{ selectedCoach.lastname }}
    </div>
    <div class="mb-3">
      <span class="font-semibold">Prénom:</span> {{ selectedCoach.firstname }}
    </div>
    <div class="mb-3">
      <span class="font-semibold">Email:</span> {{ selectedCoach.email }}
    </div>
    <div class="mb-3">
      <span class="font-semibold">Téléphone:</span> {{ selectedCoach.phone || 'Non renseigné' }}
    </div>
    <div class="mb-3">
      <span class="font-semibold">Numéro ACACED:</span> {{ selectedCoach.acacedNumber }}
    </div>
    <div class="mb-3">
      <span class="font-semibold">Date d'inscription:</span> {{ selectedCoach.registrationDate | date:'dd/MM/yyyy' }}
    </div>
    <div class="mb-3">
      <span class="font-semibold">Email validé:</span> {{ selectedCoach.emailValidated ? 'Oui' : 'Non' }}
    </div>
    <div class="mb-3">
      <span class="font-semibold">Compte actif:</span> {{ selectedCoach.isActive ? 'Oui' : 'Non' }}
    </div>
  </div>

  <ng-template pTemplate="footer">
    <button
      pButton
      label="Fermer"
      icon="pi pi-times"
      (click)="detailsVisible = false">
    </button>
  </ng-template>
</p-dialog>
