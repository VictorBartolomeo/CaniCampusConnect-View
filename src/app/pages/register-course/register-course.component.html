<div class="card px-10 mt-10">
  <h1 class="text-3xl font-bold mb-10">Consulter les cours disponibles</h1>
  <p-table
    [value]="courses"
    [paginator]="true"
    [rows]="10"
    [tableStyle]="{ 'min-width': '50rem' }"
    [rowsPerPageOptions]="[5, 10, 20]"
    rowHover="true"
    stripedRows="true"
  >
    <ng-template pTemplate="header"> <!-- Corrected from #header to pTemplate="header" -->
      <tr>
        <th>Cours</th>
        <th>Description</th>
        <th>Coach</th> <!-- Assuming this was meant to be Coach, not number of places -->
        <th>Date</th>
        <th>Jauge</th>
        <th></th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-course> <!-- Corrected from #body to pTemplate="body" -->
      <tr>
        <td class="font-bold">{{ course.title }}</td>
        <td>{{ course.description }}</td>
        <td>{{ course.coach.firstname }} {{ course.coach.lastname }}</td>
        <td>{{ course.startDatetime | date : "dd MMMM yyyy" }}</td>
        <td> {{course.registrations.length}} / {{ course.maxCapacity }}</td>
        <td class="flex gap-5">
          <div>
            <p-toast position="bottom-center"/> <!-- Note: p-toast is usually best placed once globally -->
            <p-confirmpopup>
              <ng-template #content let-message>
                <div
                  class="flex flex-col items-center w-full gap-4 border-b border-surface-200 dark:border-surface-700 p-4 mb-4 pb-0"
                >
                  <i [class]="message.icon" class="!text-6xl text-primary-500"></i>
                  <p>{{ message.message }}</p>
                </div>
              </ng-template>
            </p-confirmpopup>
            <fa-icon class="cursor-pointer text-2xl hover:opacity-80"
                     [icon]="faPaw" (click)="openConfirmPopup(course, $event)" label="Save" ></fa-icon> <!-- Modified method name and added $event -->
          </div>
          <div>
            <!-- Pass the course to showDialog and ensure selectedCourseForDialog is used in the dialog -->
            <fa-icon class="cursor-pointer text-2xl hover:opacity-80" [icon]="faEye" (click)="showCourseDialog(course)" label="Show" ></fa-icon>
            <p-dialog header="Détails du cours: {{ selectedCourseForDialog?.title }}" [modal]="true" [(visible)]="dialogVisible" [style]="{ width: '50rem' }" [breakpoints]="{ '1199px': '75vw', '575px': '90vw' }" [maximizable]="true">
              <div *ngIf="selectedCourseForDialog">
                <p><strong>Description:</strong> {{ selectedCourseForDialog.description }}</p>
                <p><strong>Coach:</strong> {{ selectedCourseForDialog.coach.firstname }} {{ selectedCourseForDialog.coach.lastname }}</p>
                <p><strong>Date:</strong> {{ selectedCourseForDialog.startDatetime | date : "dd MMMM yyyy" }}</p>
                <p><strong>Jauge:</strong> {{selectedCourseForDialog.registrations.length}} / {{ selectedCourseForDialog.maxCapacity }}</p>
                <!-- Ajoutez d'autres détails du cours que vous souhaitez afficher -->
              </div>
              <ng-template pTemplate="footer">
                <button pButton type="button" label="Fermer" icon="pi pi-times" (click)="dialogVisible = false" class="p-button-text"></button>
              </ng-template>
            </p-dialog>
          </div>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>
